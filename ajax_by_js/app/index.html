<!doctype html>
<html class="no-js">

<head>
  <meta charset="utf-8">
  <title>Async by Arun Vijayarengan</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link href="assets/css/style.min.css" rel="stylesheet">

  <script src="assets/components/modernizr/modernizr.js"></script>
</head>

<body>

  
  <div class="main" role="main">
    
    <h1>Async Communication</h1>
    <button type="button" onclick="loadJSON()">Load Data</button>
  </div>

  
  <script>
    function loadJSON() {
      var json_url = "/sample.json";
      var xhr = new XMLHttpRequest();
      //onreadystatechange - is a callback function called when readyState property changes
      //Before request initialized -- readyState is 0;
      console.log(xhr.readyState);
      xhr.onreadystatechange = function () {
        // state changes 5 times
        /*
          readyState - Holds the status of the XMLHttpRequest. Changes from 0 to 4: 
          0: request not initialized 
          1: server connection established
          2: request received 
          3: processing request 
          4: request finished and response is ready
        */
        if (xhr.readyState == 4 && xhr.status == 200) {
          //When readyState is 4 and status is 200, the response is ready
          //xhr.status	//200: "OK"  -- 404: Page not found

          // JSON.parse to parse JSON data
          var jsonObj = JSON.parse(xhr.response);
          console.log(jsonObj);
          //xhr.responseText - 	get the response data as a string
          //xhr.responseXML - 	get the response data as XML data

          // jsonObj variable now has the entire JSON 
          //debugger;


        }

        console.log(xhr.status);

      }

      // Send a Request to Server
      //Syntax: xhr.open(type_of_request, url, async? )
      xhr.open("GET", json_url, true);
      //Sends the request to the server (used for GET)
      xhr.send();

      //for POST Method the syntax is: 
      //xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      //xhr.send("fname=Arun&lname=Vijayarengan"); 
    }

    //Complete list Ajax events here
    // http://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp
  </script>


  <script src="assets/components/jquery/jquery.min.js"></script>
  <script src="assets/js/scripts.min.js"></script>


</body>

</html>